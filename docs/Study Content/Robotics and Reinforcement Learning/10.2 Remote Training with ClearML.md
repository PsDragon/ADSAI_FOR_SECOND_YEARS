# Remote Training Jobs: Pendulum Control with RL

Use the Stable Baselines 3 library to train a reinforcement learning agent to control the pendulum environment.

Use the following code to train the agent:

```python
import gym
import numpy as np
from stable_baselines3 import PPO
from stable_baselines3.common.evaluation import evaluate_policy
from stable_baselines3.common.callbacks import EvalCallback

# Create a vectorsied environment
env = gym.make("Pendulum-v1", g=9.81)

# Create the model
model = PPO("MlpPolicy", env, verbose=1)

# Train the model
model.learn(total_timesteps=10000, progress_bar=True) # you will need to train for at least 500000 timesteps

# Evaluate the model
mean_reward, std_reward = evaluate_policy(model, env, n_eval_episodes=10)
print(f"mean_reward:{mean_reward:.2f} +/- {std_reward}")

# Demo the model
env = gym.make("Pendulum-v1")
obs = env.reset()
for i in range(200):
    action, _states = model.predict(obs, deterministic=True)
    obs, rewards, dones, info = env.step(action)
    env.render()
```

ARGPARSE